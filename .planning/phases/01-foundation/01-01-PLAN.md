---
phase: 01-foundation
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - tailwind.config.ts
  - postcss.config.mjs
  - src/styles/tokens.css
  - src/styles/globals.css
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/components/ui/Button.tsx
  - src/components/ui/Input.tsx
  - src/components/ui/Card.tsx
  - src/components/layout/AppShell.tsx
  - src/components/layout/Navbar.tsx
  - src/lib/constants.ts
autonomous: true
requirements:
  - DS-01
  - DS-02
  - DS-03
  - DS-04
  - DS-05
  - DS-06
  - DS-07

must_haves:
  truths:
    - "The Next.js app boots at localhost:3000 without errors"
    - "Japandi Calm Tech color tokens are applied via CSS variables used in Tailwind config"
    - "Cormorant Garamond renders for display/heading text, DM Sans renders for all UI text"
    - "Phosphor Icons (thin) are available and render in at least one component"
    - "The 4px grid spacing scale is enforced in Tailwind theme"
    - "An AppShell wraps pages with a Navbar visible at the top"
    - "Dark mode token layer exists (light mode active by default)"
  artifacts:
    - path: "src/styles/tokens.css"
      provides: "Japandi Calm Tech CSS custom properties — Washi Paper neutrals, Sage accent, spacing scale, radius, motion"
      contains: "--color-washi"
    - path: "tailwind.config.ts"
      provides: "Tailwind theme extension wired to CSS variables"
      contains: "tokens"
    - path: "src/app/layout.tsx"
      provides: "Root layout with font loading and global CSS import"
      exports: ["default"]
    - path: "src/components/layout/AppShell.tsx"
      provides: "Page wrapper with Navbar slot"
      exports: ["AppShell"]
    - path: "src/components/ui/Button.tsx"
      provides: "Reusable Button with token-based variants"
      exports: ["Button"]
  key_links:
    - from: "tailwind.config.ts"
      to: "src/styles/tokens.css"
      via: "CSS variable references in theme.extend.colors"
      pattern: "var\\(--color-"
    - from: "src/app/layout.tsx"
      to: "src/styles/globals.css"
      via: "import at top of file"
      pattern: "import.*globals.css"
    - from: "src/components/layout/AppShell.tsx"
      to: "src/components/layout/Navbar.tsx"
      via: "import and render"
      pattern: "<Navbar"
---

<objective>
Bootstrap the Next.js 14 project with the Japandi Calm Tech design system fully wired as CSS tokens and a Tailwind theme. Establish the AppShell, Navbar, and base UI primitives (Button, Input, Card) that every subsequent plan builds on.

Purpose: Every screen in CULTX depends on design system tokens being established first. This plan is the foundation of the foundation.
Output: A running Next.js app with design system tokens, base components, and an AppShell layout.
</objective>

<execution_context>
@/Users/jccruzb-local/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jccruzb-local/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@claude.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js 14 project with TypeScript and Tailwind CSS</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    tailwind.config.ts
    postcss.config.mjs
    src/app/layout.tsx
    src/app/page.tsx
    src/lib/constants.ts
  </files>
  <action>
Run `npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*" --yes` in the project root to scaffold the Next.js 14 app with App Router, TypeScript strict mode, and Tailwind CSS preconfigured.

After scaffolding:

1. In `next.config.ts`: no changes needed beyond scaffold defaults.

2. In `tsconfig.json`: ensure `"strict": true` is set.

3. In `tailwind.config.ts`: clear the default content array and configure properly:
```ts
content: ["./src/**/*.{ts,tsx}"],
```
The theme extension will be wired in Task 2.

4. Create `src/lib/constants.ts` with interest options, profile types, regions, and exploration modes (these are shared across onboarding and profile):
```ts
export const CULTURAL_INTERESTS = [
  "Theatre", "Painting", "Architecture", "Dance", "Literature",
  "Museums", "Exhibitions", "Film", "Cultural heritage",
  "Regional history", "Cultural events"
] as const;

export const PROFILE_TYPES = ["General audience", "Student", "Academic", "Cultural professional"] as const;
export const REGIONS = ["North", "Central", "South", "West", "Peninsula"] as const;
export const EXPLORATION_MODES = ["My region", "Entire Mexico", "Both"] as const;

export type CulturalInterest = typeof CULTURAL_INTERESTS[number];
export type ProfileType = typeof PROFILE_TYPES[number];
export type Region = typeof REGIONS[number];
export type ExplorationMode = typeof EXPLORATION_MODES[number];

export const LOCAL_STORAGE_KEYS = {
  USER: "cultx:user",
  CHAT: "cultx:chat",
} as const;
```

5. In `src/app/layout.tsx`: import fonts (Cormorant Garamond + DM Sans from next/font/google) and apply them as CSS variables. Import globals.css. Set metadata for CULTX.

6. In `src/app/page.tsx`: placeholder that redirects to /login using Next.js redirect (import { redirect } from "next/navigation"; redirect("/login");).

Install Phosphor Icons: `npm install @phosphor-icons/react`.
  </action>
  <verify>Run `npm run dev` — server starts on localhost:3000 without TypeScript errors. Run `npm run build` — completes without errors. Check `node_modules/@phosphor-icons/react` exists.</verify>
  <done>Next.js app builds and runs. TypeScript strict mode on. Phosphor Icons installed. Constants file exports all enum types. Root page redirects to /login.</done>
</task>

<task type="auto">
  <name>Task 2: Implement Japandi Calm Tech design tokens and base UI components</name>
  <files>
    src/styles/tokens.css
    src/styles/globals.css
    tailwind.config.ts
    src/components/ui/Button.tsx
    src/components/ui/Input.tsx
    src/components/ui/Card.tsx
    src/components/layout/AppShell.tsx
    src/components/layout/Navbar.tsx
  </files>
  <action>
1. Create `src/styles/tokens.css` with the complete Japandi Calm Tech token set as CSS custom properties:

```css
:root {
  /* Washi Paper Neutrals */
  --color-washi-50: #faf9f7;
  --color-washi-100: #f5f3ef;
  --color-washi-200: #ece8e0;
  --color-washi-300: #ddd8cc;
  --color-washi-400: #c8c0b0;
  --color-washi-500: #b0a594;
  --color-washi-600: #8f8070;
  --color-washi-700: #6e6358;
  --color-washi-800: #4e4740;
  --color-washi-900: #2e2a26;

  /* Sage Accent */
  --color-sage-300: #b8c4a8;
  --color-sage-400: #9aad88;
  --color-sage-500: #7d9469;
  --color-sage-600: #637a52;

  /* Semantic tokens — light mode */
  --color-bg: var(--color-washi-50);
  --color-surface: #ffffff;
  --color-surface-raised: var(--color-washi-100);
  --color-border: var(--color-washi-200);
  --color-text-primary: var(--color-washi-900);
  --color-text-secondary: var(--color-washi-600);
  --color-text-muted: var(--color-washi-500);
  --color-accent: var(--color-sage-500);
  --color-accent-hover: var(--color-sage-600);
  --color-focus-ring: var(--color-sage-400);

  /* Typography */
  --font-display: var(--font-cormorant), "Georgia", serif;
  --font-ui: var(--font-dm-sans), "system-ui", sans-serif;

  /* Spacing scale (4px base) */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-6: 24px;
  --space-8: 32px;
  --space-12: 48px;
  --space-16: 64px;

  /* Border radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;

  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(46, 42, 38, 0.08);
  --shadow-md: 0 4px 12px rgba(46, 42, 38, 0.10);

  /* Motion — calm tech rules (200ms, no bounce) */
  --duration-fast: 150ms;
  --duration-base: 200ms;
  --duration-slow: 300ms;
  --ease-base: cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: var(--duration-base) var(--ease-base);
}

/* Dark mode tokens (bonus — light mode is primary for v1) */
[data-theme="dark"] {
  --color-bg: var(--color-washi-900);
  --color-surface: var(--color-washi-800);
  --color-surface-raised: var(--color-washi-700);
  --color-border: var(--color-washi-700);
  --color-text-primary: var(--color-washi-50);
  --color-text-secondary: var(--color-washi-300);
  --color-text-muted: var(--color-washi-400);
}
```

2. Create `src/styles/globals.css`:
```css
@import "./tokens.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    background-color: var(--color-bg);
    color: var(--color-text-primary);
    font-family: var(--font-ui);
    -webkit-font-smoothing: antialiased;
  }

  /* Heading elements use display font */
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-display);
  }

  /* Focus ring */
  :focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
  }
}
```

3. Update `tailwind.config.ts` to extend theme with CSS variable references:
```ts
import type { Config } from "tailwindcss";

const config: Config = {
  content: ["./src/**/*.{ts,tsx}"],
  theme: {
    extend: {
      colors: {
        bg: "var(--color-bg)",
        surface: "var(--color-surface)",
        "surface-raised": "var(--color-surface-raised)",
        border: "var(--color-border)",
        "text-primary": "var(--color-text-primary)",
        "text-secondary": "var(--color-text-secondary)",
        "text-muted": "var(--color-text-muted)",
        accent: "var(--color-accent)",
        "accent-hover": "var(--color-accent-hover)",
        "focus-ring": "var(--color-focus-ring)",
      },
      fontFamily: {
        display: "var(--font-display)",
        ui: "var(--font-ui)",
      },
      transitionDuration: {
        base: "200ms",
      },
    },
  },
  plugins: [],
};
export default config;
```

4. Create `src/components/ui/Button.tsx` — token-based variants:
```tsx
import { ButtonHTMLAttributes, forwardRef } from "react";
import { cn } from "@/lib/utils";

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: "primary" | "secondary" | "ghost";
  size?: "sm" | "md" | "lg";
}

export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ variant = "primary", size = "md", className, children, ...props }, ref) => {
    return (
      <button
        ref={ref}
        className={cn(
          "inline-flex items-center justify-center font-ui font-medium rounded-md transition-[background-color,box-shadow] duration-base",
          "focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-focus-ring",
          "disabled:opacity-50 disabled:cursor-not-allowed",
          {
            "bg-accent text-surface hover:bg-accent-hover": variant === "primary",
            "bg-surface-raised text-text-primary border border-border hover:border-accent": variant === "secondary",
            "text-text-secondary hover:text-text-primary hover:bg-surface-raised": variant === "ghost",
          },
          {
            "px-3 py-1.5 text-sm": size === "sm",
            "px-4 py-2 text-sm": size === "md",
            "px-6 py-3 text-base": size === "lg",
          },
          className
        )}
        {...props}
      >
        {children}
      </button>
    );
  }
);
Button.displayName = "Button";
```

5. Create `src/components/ui/Input.tsx`:
```tsx
import { InputHTMLAttributes, forwardRef } from "react";
import { cn } from "@/lib/utils";

export const Input = forwardRef<HTMLInputElement, InputHTMLAttributes<HTMLInputElement>>(
  ({ className, ...props }, ref) => (
    <input
      ref={ref}
      className={cn(
        "w-full rounded-md border border-border bg-surface px-4 py-2.5",
        "font-ui text-sm text-text-primary placeholder:text-text-muted",
        "transition-[border-color,box-shadow] duration-base",
        "focus:outline-none focus:border-accent focus:ring-1 focus:ring-accent",
        className
      )}
      {...props}
    />
  )
);
Input.displayName = "Input";
```

6. Create `src/components/ui/Card.tsx`:
```tsx
import { HTMLAttributes, forwardRef } from "react";
import { cn } from "@/lib/utils";

export const Card = forwardRef<HTMLDivElement, HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      className={cn(
        "rounded-lg bg-surface border border-border shadow-sm",
        "transition-shadow duration-base",
        className
      )}
      style={{ boxShadow: "var(--shadow-sm)" }}
      {...props}
    />
  )
);
Card.displayName = "Card";
```

7. Create `src/lib/utils.ts` with `cn` helper (clsx + tailwind-merge). Install deps: `npm install clsx tailwind-merge`.

8. Create `src/components/layout/Navbar.tsx` — minimal top nav with CULTX wordmark:
```tsx
import Link from "next/link";

export function Navbar() {
  return (
    <header className="sticky top-0 z-50 border-b border-border bg-surface/90 backdrop-blur-sm">
      <div className="mx-auto flex h-14 max-w-5xl items-center justify-between px-4">
        <Link href="/" className="font-display text-xl font-semibold tracking-wide text-text-primary">
          CULTX
        </Link>
      </div>
    </header>
  );
}
```

9. Create `src/components/layout/AppShell.tsx`:
```tsx
import { Navbar } from "./Navbar";

interface AppShellProps {
  children: React.ReactNode;
  showNav?: boolean;
}

export function AppShell({ children, showNav = true }: AppShellProps) {
  return (
    <div className="min-h-screen bg-bg">
      {showNav && <Navbar />}
      <main>{children}</main>
    </div>
  );
}
```

10. Update `src/app/layout.tsx` to load Cormorant Garamond and DM Sans from next/font/google, apply CSS variable names `--font-cormorant` and `--font-dm-sans`, and import globals.css.
  </action>
  <verify>
1. Run `npm run dev` — no TypeScript or build errors in terminal.
2. Visit localhost:3000 — page loads, header shows "CULTX" in Cormorant Garamond font.
3. Run `grep -r "var(--color-washi" src/styles/tokens.css` — confirms token definitions present.
4. Run `npm run build` — TypeScript compilation succeeds with zero errors.
  </verify>
  <done>Design system tokens defined in CSS variables. Tailwind theme references tokens. Cormorant Garamond and DM Sans render. AppShell and Navbar render correctly. Button, Input, Card primitives export without type errors.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes with zero TypeScript errors
2. `npm run dev` serves localhost:3000 — page loads and redirects to /login (404 expected at this stage)
3. `src/styles/tokens.css` contains `--color-washi-*`, `--color-sage-*`, `--color-bg`, `--font-display`, `--duration-base`
4. `tailwind.config.ts` theme extends with `bg`, `surface`, `accent`, `text-primary` mapped to CSS vars
5. `src/components/ui/Button.tsx` exports Button with primary/secondary/ghost variants
6. `src/app/layout.tsx` loads Cormorant Garamond and DM Sans via next/font/google
</verification>

<success_criteria>
- Next.js 14 project scaffolded with TypeScript strict mode and Tailwind CSS
- Japandi Calm Tech tokens implemented as CSS custom properties (Washi Paper neutrals, Sage accent)
- Token semantics: `--color-bg`, `--color-surface`, `--color-text-primary`, `--color-accent`, `--color-focus-ring`
- Motion tokens: `--duration-base: 200ms`, `--ease-base: cubic-bezier(0.4, 0, 0.2, 1)` (no bounce, calm tech)
- Dark mode token layer defined under `[data-theme="dark"]` (light mode active by default)
- Cormorant Garamond renders for headings/display, DM Sans renders for all UI text
- Phosphor Icons (`@phosphor-icons/react`) installed and importable
- AppShell + Navbar render at root with CULTX wordmark
- Button, Input, Card primitives use tokens and pass TypeScript strict compilation
- WCAG AA contrast verifiable: `--color-text-primary` (#2e2a26) on `--color-bg` (#faf9f7) exceeds 4.5:1
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
